# Source all analysis functions and data silently
# This loads everything without prints, outputs, or document generation

# BULLETPROOF SILENCING: Store original functions and override them
suppressMessages(suppressWarnings(local({
  
  # Store original output functions
  original_cat <- cat
  original_print <- print
  original_message <- message
  original_warning <- warning
  original_writeLines <- writeLines
  
  # Override all output functions to do nothing
  assign("cat", function(...) invisible(NULL), envir = .GlobalEnv)
  assign("print", function(...) invisible(NULL), envir = .GlobalEnv)
  assign("message", function(...) invisible(NULL), envir = .GlobalEnv)
  assign("warning", function(...) invisible(NULL), envir = .GlobalEnv)
  assign("writeLines", function(...) invisible(NULL), envir = .GlobalEnv)
  
  # Source all scripts with complete silence
  invisible(capture.output({
    source("Immunosuppressive metabolites feature table/Scripts/01_libraries")
    source("Immunosuppressive metabolites feature table/Scripts/02_setup")
    source("Immunosuppressive metabolites feature table/Scripts/03_plotting_functions")
    source("Immunosuppressive metabolites feature table/Scripts/03_tests")
    source("Immunosuppressive metabolites feature table/Scripts/04_PODdist")
  }))
  
  # RESTORE original functions after sourcing is complete
  assign("cat", original_cat, envir = .GlobalEnv)
  assign("print", original_print, envir = .GlobalEnv)
  assign("message", original_message, envir = .GlobalEnv)
  assign("warning", original_warning, envir = .GlobalEnv)
  assign("writeLines", original_writeLines, envir = .GlobalEnv)
  
})))

# All data objects are now available in environment:
# - metabolite_data, nonlog2_data, patients_with_2R
# - acr_0r, acr_1r, acr_0_1r, acr_2r
# - pre_2R, active_2R, post_2R  
# - ttest_res, ttest_res_median, etc.
# - All matched analysis results
# - All POD analysis objects

cat("Analysis data loaded silently. All objects available in environment.\n")